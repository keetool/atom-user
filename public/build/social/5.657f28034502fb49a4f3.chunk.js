(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{534:function(e,t,r){e.exports={"post-layout-post":"__DaYUGt","post-header":"__3JRBrt","post-creator":"__10gkk7","post-creator-content":"__3DM1Yl","post-name":"__3DQhv3","post-text-time":"__3mKW7q","post-action":"__3SLdzV","post-action-icon":"__2-brKx","post-action-dropdown":"__3CH3Bv","post-content":"__2wjpF8","post-content-body":"__g15uC_","post-content-view-more":"__3-ED-e","post-layout-action":"__PUBz9g","post-active-mark":"__2E7Yal","post-action-left":"__2BXBDw","post-action-comment":"__LRw-RM","post-text-comment":"__1t3AeF","post-disabled":"__1tS9-W","post-layout-comment":"__-jFSXy","post-layout-image":"__3uck3R","post-image":"__3wxkfV","post-divider":"__3aJeT6","post-vertical":"__3AVbA8","post-footer":"__3GhPdU"}},535:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.findLinkAndAddTab=a;t.removeScriptInString=i;t.removeStyleInString=u;t.removeTagA=s;t.html2text=l;t.convertDataBeforeAddEditor=c;t.convertDataPastedEditor=p;t.convertDataEditor=d;t.removeEntities=v;t.isViewMore=m;t.splitStrToViewMore=y;t.overLineNumber=g;t.overMaxString=_;var n=200;var o=5;function a(e){var t=/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/g;return e.replace(t,function(e){return'<a target="_blank" href="'+e+'">'+e+"</a>"})}function i(e){var t=/(<|%3C)script[\s\S]*?(>|%3E)[\s\S]*?(<|%3C)(\/|%2F)script[\s\S]*?(>|%3E)/g;return e.replace(t,"")}function u(e){var t=/(<|%3C)style[\s\S]*?(>|%3E)[\s\S]*?(<|%3C)(\/|%2F)style[\s\S]*?(>|%3E)/g;return e.replace(t,"")}function s(e){var t=/<[/]*a[^>]*>/g;return e.replace(t,"")}function l(e){var t=/<[^>]*>/g;return e.replace(t,"")}function c(e){e=s(e);return e}function f(e){var t=document.createElement("div");t.textContent=e;return t.innerHTML}function p(e){e=f(e);e=i(e);e=l(e);return e}function d(e){e=i(e);e=u(e);e=a(e);return e}function v(e){var t=/&[^;]*;/g;return e.replace(t,"")}function m(e){var t=l(e);t=v(t);return t.length>n}function h(e){var t=document.createElement("div");t.innerHTML=e;return t.childElementCount}function b(e){var t="";var r=document.createElement("div");r.innerHTML=e;var n=r.childNodes;for(var a=0;a<o;a++){if(n[a].nodeName==="#text"){t+=f(n[a].data)}else{t+=n[a].outerHTML}}return t}function y(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:o;var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:n;if(g(e,t)){e=b(e,t)+"<div>...</div>"}if(_(e,r)){e=e.substring(0,r)+"<div>...</div>"}return e}function g(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:o;var r=h(e);return r>t}function _(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n;return e.length>t}},546:function(e,t,r){e.exports={"post-comment-container-comment":"__2r2pbG","post-comment-text-load-more":"__2GNKoe","post-comment-layout-content":"__1h3BYB","post-comment-content":"__X7vTgg","post-comment-comment":"__3DL9UJ","post-comment-name":"__1E3x2C","post-comment-content-comment":"__1Ddrbh","post-comment-content-view-more":"__1q_akY","post-comment-layout-action":"__1epVOo","post-comment-action-left":"__1GYzjK","post-comment-action-right":"__YXMNun","post-comment-action-reply":"__1oqbf5","post-comment-text-time":"__2mULM3","post-comment-divider":"__2qebNE","post-comment-vertical":"__2QUeuC"}},547:function(e,t,r){e.exports={"editor-post-layout-editor":"__1-Uz1E","editor-post-disable":"__3hzu4k","editor-post-container":"__22fg5d","editor-post-editor":"__9WoFYm","editor-post-zoom-text":"__2Kf3Qv","editor-post-container-action":"__3OeoMV","editor-post-layout-action":"__3q_nap","editor-post-action-photo":"__25izQ1","editor-post-divider":"__28wqZ9","editor-post-horizontal":"__1_3nUb","editor-post-layout-image":"__21AQV_","editor-post-scrollable":"__3gGiWf","editor-post-container-image":"__HnuaTl","editor-post-image":"__3-u88_","editor-post-image-add":"__39dL-9","editor-post-image-action":"__3LrHgi","editor-post-image-action-view":"__3E5NCX","editor-post-image-action-remove":"__2uDRJA","editor-post-background-image":"__m3cDdJ","editor-post-loading":"__16D68x"}},550:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.addPostApi=s;t.editPostApi=l;t.getPostsApi=c;t.getPostsByUserApi=f;t.getHotPostsApi=p;t.getPostApi=d;t.upVoteApi=v;t.downVoteApi=m;t.deletePostApi=h;var n=r(202);var o=u(n);var a=r(136);var i=r(527);function u(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.body,r=e.image_ids;var n=a.MERCHANT_API_URL+"v1/post";return o.default.post(n,{body:t,image_ids:r})}function l(e){var t=e.body,r=e.image_ids,n=e.id;var i=a.MERCHANT_API_URL+("v1/post/"+n);return o.default.put(i,{body:t,image_ids:r})}function c(e){var t=void 0;if((0,i.isLoggedIn)()){t=a.MERCHANT_API_URL+"v1/load-post"}else{t=a.PUBLIC_MERCHANT_API_URL+"v1/load-post"}return o.default.get(t,{params:{post_id:e}})}function f(e,t){var r=a.MERCHANT_API_URL+("v1/user/"+e+"/post");return o.default.get(r,{params:{post_id:t}})}function p(){var e=a.MERCHANT_API_URL+"v1/post/list/top";return o.default.get(e)}function d(e){var t=void 0;if((0,i.isLoggedIn)()){t=a.MERCHANT_API_URL+("v1/post/"+e)}else{t=a.PUBLIC_MERCHANT_API_URL+("v1/post/"+e)}return o.default.get(t)}function v(e){var t=a.MERCHANT_API_URL+("v1/post/"+e+"/vote/up");return o.default.post(t)}function m(e){var t=a.MERCHANT_API_URL+("v1/post/"+e+"/vote/down");return o.default.post(t)}function h(e){var t=a.MERCHANT_API_URL+("v1/post/"+e+"/hide");return o.default.put(t)}},554:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.addCommentApi=s;t.getCommentsApi=l;t.upVoteApi=c;t.downVoteApi=f;var n=r(202);var o=u(n);var a=r(136);var i=r(527);function u(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var r=a.MERCHANT_API_URL+("v1/post/"+e+"/comment");return o.default.post(r,{value:t.value})}function l(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";var n=void 0;if((0,i.isLoggedIn)()){n=a.MERCHANT_API_URL+("v1/post/"+e+"/load-comment")}else{n=a.PUBLIC_MERCHANT_API_URL+("v1/post/"+e+"/load-comment")}return o.default.get(n,{params:{comment_id:t,limit:r}})}function c(e){var t=a.MERCHANT_API_URL+("v1/comment/"+e+"/vote/up");return o.default.post(t)}function f(e){var t=a.MERCHANT_API_URL+("v1/comment/"+e+"/vote/down");return o.default.post(t)}},558:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var a,i,u,s,l,c,f,p,d,v,m,h,b,y,g,_,w,E,P,O,C;var k=r(525);var j=r(526);var M=r(550);var x=r(632);var I=z(x);var A=r(631);var T=z(A);var R=r(593);var D=r(535);var N=r(199);var V=r(200);var S=r(529);function z(e){return e&&e.__esModule?e:{default:e}}function L(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,a){try{var i=t[o](a);var u=i.value}catch(e){r(e);return}if(i.done){e(u)}else{return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}function U(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function H(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function B(e,t,r,n,o){var a={};Object["ke"+"ys"](n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(o&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(o):void 0;a.initializer=undefined}if(a.initializer===void 0){Object["define"+"Property"](e,t,a);a=null}return a}function F(e,t){throw new Error("Decorating class property failed. Please ensure that transform-class-properties is enabled.")}var q=(a=k.action.bound,s=function(){function e(t,r){H(this,e);U(this,"post",l,this);U(this,"isVoting",c,this);U(this,"isMarking",f,this);U(this,"isDeleting",p,this);U(this,"errorVote",d,this);U(this,"errorDelete",v,this);U(this,"storeEditorComment",m,this);U(this,"storeComment",h,this);U(this,"showModalEdit",b,this);U(this,"config",y,this);U(this,"addUpVotePost",g,this);U(this,"addDownVotePost",_,this);U(this,"removeVotePost",w,this);U(this,"addBookmarked",E,this);U(this,"deleteBookmarked",P,this);U(this,"changeDataPost",O,this);U(this,"changeStatusModal",C,this);this.post=n({},t);this.storeComment=new T.default(t);this.storeEditorComment=new I.default(t);if(r){this.config=n({},this.config,r)}}o(e,[{key:"addMarkPost",value:function(){var e=L(regeneratorRuntime.mark(function e(){var t=this;var r,o,a,i,u;return regeneratorRuntime.wrap(function e(s){while(1){switch(s.prev=s.next){case 0:if(!this.isMarking){s.next=2;break}return s.abrupt("return");case 2:this.isMarking=true;r=this.post;o=r.id;a=n({},r);this.addBookmarked();s.prev=7;s.next=10;return(0,R.addMarkPostApi)(o);case 10:i=s.sent;u=i.data;if((0,j.httpSuccess)(i.status)){this.changeDataPost(u.data.post)}else{this.changeDataPost(a)}s.next=18;break;case 15:s.prev=15;s.t0=s["catch"](7);this.changeDataPost(a);case 18:s.prev=18;(0,k.runInAction)(function(){t.isMarking=false});return s.finish(18);case 21:case"end":return s.stop()}}},e,this,[[7,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"deleteMarkPost",value:function(){var e=L(regeneratorRuntime.mark(function e(){var t=this;var r,o,a,i;return regeneratorRuntime.wrap(function e(u){while(1){switch(u.prev=u.next){case 0:if(!this.isMarking){u.next=2;break}return u.abrupt("return");case 2:this.isMarking=true;r=this.post;o=r.id;a=n({},r);this.deleteBookmarked();u.prev=7;u.next=10;return(0,R.deleteMarkPostApi)(o);case 10:i=u.sent;if((0,j.httpSuccess)(i.status)){}else{this.changeDataPost(a)}u.next=17;break;case 14:u.prev=14;u.t0=u["catch"](7);this.changeDataPost(a);case 17:u.prev=17;(0,k.runInAction)(function(){t.isMarking=false});return u.finish(17);case 20:case"end":return u.stop()}}},e,this,[[7,14,17,20]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"upVote",value:function(){var e=L(regeneratorRuntime.mark(function e(){var t=this;var r,o,a,i,u;return regeneratorRuntime.wrap(function e(s){while(1){switch(s.prev=s.next){case 0:if(!this.isVoting){s.next=2;break}return s.abrupt("return");case 2:this.isVoting=true;r=this.post;o=r.id;a=n({},r);if(r.vote==1){this.removeVotePost()}else{this.addUpVotePost()}s.prev=7;s.next=10;return(0,M.upVoteApi)(o);case 10:i=s.sent;u=i.data;if((0,j.httpSuccess)(i.status)){this.changeDataPost(u.data)}else{this.changeDataPost(a)}s.next=18;break;case 15:s.prev=15;s.t0=s["catch"](7);this.changeDataPost(a);case 18:s.prev=18;(0,k.runInAction)(function(){t.isVoting=false});return s.finish(18);case 21:case"end":return s.stop()}}},e,this,[[7,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"downVote",value:function(){var e=L(regeneratorRuntime.mark(function e(){var t=this;var r,o,a,i,u;return regeneratorRuntime.wrap(function e(s){while(1){switch(s.prev=s.next){case 0:if(!this.isVoting){s.next=2;break}return s.abrupt("return");case 2:this.isVoting=true;r=this.post;o=r.id;a=n({},r);if(r.vote==-1){this.removeVotePost()}else{this.addDownVotePost()}s.prev=7;s.next=10;return(0,M.downVoteApi)(o);case 10:i=s.sent;u=i.data;if((0,j.httpSuccess)(i.status)){this.changeDataPost(u.data)}else{this.changeDataPost(a)}s.next=18;break;case 15:s.prev=15;s.t0=s["catch"](7);this.changeDataPost(a);case 18:s.prev=18;(0,k.runInAction)(function(){t.isVoting=false});return s.finish(18);case 21:case"end":return s.stop()}}},e,this,[[7,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"deletePost",value:function(){var e=L(regeneratorRuntime.mark(function e(){var t=this;var r,n,o;return regeneratorRuntime.wrap(function e(a){while(1){switch(a.prev=a.next){case 0:if(!this.isDeleting){a.next=2;break}return a.abrupt("return");case 2:this.isDeleting=true;this.errorDelete=null;r=this.post;n=r.id;a.prev=6;a.next=9;return(0,M.deletePostApi)(n);case 9:o=a.sent;if((0,j.httpSuccess)(o.status)){(0,S.messageSuccess)((0,V.translateI18n)("social.home.post_item.delete_post_success"));if(this.config.handleDelete){this.config.handleDelete(n)}}else{(0,k.runInAction)(function(){t.errorDelete=(0,j.messageHttpRequest)()})}a.next=16;break;case 13:a.prev=13;a.t0=a["catch"](6);(0,k.runInAction)(function(){t.errorDelete=(0,j.messageHttpRequest)(a.t0)});case 16:a.prev=16;(0,k.runInAction)(function(){t.isDeleting=false});if(this.errorDelete){(0,S.messageError)(this.errorDelete)}return a.finish(16);case 20:case"end":return a.stop()}}},e,this,[[6,13,16,20]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"incComment",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:1;this.post.num_comments+=t}},{key:"disableViewMore",value:function e(){this.config.viewMore=false}},{key:"content",get:function e(){if(this.viewMore){return(0,D.splitStrToViewMore)(this.post.body)}else{return this.post.body}}},{key:"viewMore",get:function e(){return!(0,N.isEmpty)(this.post.body)&&((0,D.isViewMore)(this.post.body)||(0,D.overLineNumber)(this.post.body))&&this.config.viewMore}}]);return e}(),l=B(s.prototype,"post",[k.observable],{enumerable:true,initializer:function e(){return{}}}),c=B(s.prototype,"isVoting",[k.observable],{enumerable:true,initializer:function e(){return false}}),f=B(s.prototype,"isMarking",[k.observable],{enumerable:true,initializer:function e(){return false}}),p=B(s.prototype,"isDeleting",[k.observable],{enumerable:true,initializer:function e(){return false}}),d=B(s.prototype,"errorVote",[k.observable],{enumerable:true,initializer:function e(){return null}}),v=B(s.prototype,"errorDelete",[k.observable],{enumerable:true,initializer:function e(){return null}}),m=B(s.prototype,"storeEditorComment",[k.observable],{enumerable:true,initializer:function e(){return{}}}),h=B(s.prototype,"storeComment",[k.observable],{enumerable:true,initializer:function e(){return{}}}),b=B(s.prototype,"showModalEdit",[k.observable],{enumerable:true,initializer:function e(){return false}}),y=B(s.prototype,"config",[k.observable],{enumerable:true,initializer:function e(){return{hideListComment:false,hideEditorComment:false,viewMore:true,handleDelete:null}}}),B(s.prototype,"addMarkPost",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"addMarkPost"),s.prototype),B(s.prototype,"deleteMarkPost",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"deleteMarkPost"),s.prototype),B(s.prototype,"upVote",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"upVote"),s.prototype),B(s.prototype,"downVote",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"downVote"),s.prototype),B(s.prototype,"deletePost",[a],Object.getOwnPropertyDescriptor(s.prototype,"deletePost"),s.prototype),g=B(s.prototype,"addUpVotePost",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(){var e=t.post;if(e.vote==0){e.upvote++}else if(e.vote==-1){e.upvote++;e.downvote--}e.vote=1}}}),_=B(s.prototype,"addDownVotePost",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(){var e=t.post;if(e.vote==0){e.downvote++}else if(e.vote==1){e.upvote--;e.downvote++}e.vote=-1}}}),w=B(s.prototype,"removeVotePost",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(){var e=t.post;if(e.vote==1){e.upvote--}else if(e.vote==-1){e.downvote--}e.vote=0}}}),E=B(s.prototype,"addBookmarked",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(){t.post.isBookmarked=1}}}),P=B(s.prototype,"deleteBookmarked",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(){t.post.isBookmarked=0}}}),O=B(s.prototype,"changeDataPost",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(e){t.post=n({},t.post,e)}}}),B(s.prototype,"incComment",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"incComment"),s.prototype),B(s.prototype,"content",[k.computed],Object.getOwnPropertyDescriptor(s.prototype,"content"),s.prototype),B(s.prototype,"disableViewMore",[k.action],Object.getOwnPropertyDescriptor(s.prototype,"disableViewMore"),s.prototype),B(s.prototype,"viewMore",[k.computed],Object.getOwnPropertyDescriptor(s.prototype,"viewMore"),s.prototype),C=B(s.prototype,"changeStatusModal",[k.action],{enumerable:true,initializer:function e(){var t=this;return function(e){t.showModalEdit=e}}}),s);t.default=q},559:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(1);var o=p(n);var a=r(198);var i=p(a);var u=r(542);var s=p(u);var l=r(537);var c=r(534);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}var d=i.default.bind(f.default);var v=function e(t){var r=t.prefixCls;return o.default.createElement("div",null,o.default.createElement("div",{className:d(r+"-layout-post")},o.default.createElement("div",{className:d(r+"-header")},o.default.createElement("div",{className:d(r+"-creator"),style:{width:"100%"}},o.default.createElement(l.RoundShape,{color:"#E0E0E0",style:{width:30,height:30}}),o.default.createElement("div",{className:d(r+"-creator-content")},o.default.createElement("div",{className:d(r+"-name")},o.default.createElement(l.TextBlock,{rows:2,color:"#E0E0E0"}))))),o.default.createElement("div",{className:d(r+"-content"),style:{paddingBottom:"100px",marginTop:"20px"}},o.default.createElement("div",{className:d(r+"-content-body")},o.default.createElement(l.TextBlock,{rows:5,color:"#E0E0E0"})))))};v.defaultProps={prefixCls:"post"};t.default=(0,s.default)()(v)},563:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(206);var o=T(n);var a=r(548);var i=T(a);var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var l;r(205);r(549);var c=r(1);var f=T(c);var p=r(2);var d=T(p);var v=r(534);var m=T(v);var h=r(198);var b=T(h);var y=r(664);var g=T(y);var _=r(660);var w=T(_);var E=r(653);var P=T(E);var O=r(523);var C=r(602);var k=T(C);var j=r(650);var M=T(j);var x=r(199);var I=r(635);var A=r(92);function T(e){return e&&e.__esModule?e:{default:e}}function R(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function D(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function N(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var V=b.default.bind(m.default);var S=(0,O.observer)(l=function(e){N(t,e);function t(e){R(this,t);var r=D(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r.incNumberComment=function(){var e=r.props.store;e.incComment()};r.handleMark=function(){var e=r.props.store;var t=e.post;if(t.isBookmarked){e.deleteMarkPost()}else{e.addMarkPost()}};r.handleDelete=function(){var e=r.props,t=e.store,n=e.t;var o=n("social.home.post_item.are_you_sure_delete_this_post?");(0,I.showDeleteConfirm)(o,"",t.deletePost)};r.handleEdit=function(){var e=r.props.store;e.changeStatusModal(true)};r.closeModalEdit=function(){var e=r.props.store;e.changeStatusModal(false)};r.handleCloseModalEdit=function(){var e=r.props.t;var t=e("social.home.post_item.are_you_sure_close_edit_this_post");var n=e("social.home.post_item.close_modal_lost_content");(0,I.showWarningConfirm)(t,n,r.closeModalEdit)};r.handleEditPostSuccess=function(e){var t=r.props.store;t.changeDataPost(e);r.closeModalEdit()};return r}s(t,[{key:"render",value:function e(){var t=this.props,r=t.store,n=t.prefixCls,a=t.t;var s=r.post,l=r.storeComment,c=r.storeEditorComment,p=r.config,d=r.isDeleting,v=r.showModalEdit;var m=(0,x.linkRoute)("/post/:postID",{postID:s.id});var h=(0,x.linkRoute)("/profile/:userID",{userID:(0,x.getValueObjectFromStringKey)(s,"creator.id")});var b=d;return f.default.createElement("div",null,f.default.createElement(o.default,{spinning:b,size:"large"},f.default.createElement("div",{className:V(n+"-layout-post")},f.default.createElement(g.default,{post:s,linkDetail:m,linkProfile:h,handleMark:this.handleMark,handleDelete:this.handleDelete,handleEdit:this.handleEdit}),f.default.createElement(w.default,{post:s,store:r}),f.default.createElement(P.default,{post:s,store:r,handleMark:this.handleMark}),f.default.createElement("div",{className:V(n+"-layout-comment")},f.default.createElement(M.default,{hideComment:p.hideListComment,hideEditorComment:p.hideEditorComment,post:s,incNumberComment:this.incNumberComment,storeComment:l,storeEditorComment:c}))),v&&f.default.createElement(i.default,{title:a("social.home.post_item.modal_edit_post_title"),visible:true,bodyStyle:{padding:0},footer:null,maskClosable:false,onCancel:this.handleCloseModalEdit},f.default.createElement(k.default,{post:u({},s),editPost:this.handleEditPostSuccess}))))}}]);return t}(f.default.Component))||l;S.defaultProps={prefixCls:"post"};S.propTypes={store:d.default.object};t.default=(0,A.translate)(function(e){return e.namespaces})(S)},571:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=t.CREATE_COMMENT="comment.create";var o=t.CREATE_NOTIFICATION="notification.create";var a=t.CREATE_POST="post.create"},572:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(641);var o=i(n);var a=r(136);function i(e){return e&&e.__esModule?e:{default:e}}var u=a.SOCKET_HOST+":"+a.SOCKET_PORT;var s=(0,o.default)(u);t.default=s},573:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(524);var o=h(n);r(528);var a=r(1);var i=h(a);var u=r(2);var s=h(u);var l=r(200);var c=r(652);var f=h(c);var p=r(198);var d=h(p);var v=r(564);var m=h(v);function h(e){return e&&e.__esModule?e:{default:e}}function b(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var y=d.default.bind(f.default);var g=function e(t){var r;var n=t.horizontal,a=t.upvote,u=t.downvote,s=t.vote,c=t.actionUpVote,f=t.actionDownVote,p=t.disabled,d=t.prefixCls;var v=!isNaN(a-u)?a-u:0;return i.default.createElement("div",{className:y(d+"-action-vote",(r={},b(r,d+"-disabled",p),b(r,d+"-action-vote-horizontal",n),r))},i.default.createElement(m.default,{placement:"topLeft",title:a+" "+(0,l.translateI18n)("social.home.post_item.upvote")},i.default.createElement(o.default,{type:"caret-up",className:y(b({},d+"-voted",s==1)),onClick:p?null:c})),i.default.createElement("div",{className:y(d+"-text-vote")},v),i.default.createElement(m.default,{placement:"top",title:u+" "+(0,l.translateI18n)("social.home.post_item.downvote")},i.default.createElement(o.default,{type:"caret-down",className:y(b({},d+"-voted",s==-1)),onClick:p?null:f})))};g.defaultProps={prefixCls:"action-vote",upvote:0,downvote:0};g.propTypes={upvote:s.default.number,downvote:s.default.number,actionUpVote:s.default.func,actionDownVote:s.default.func,disabled:s.default.bool,vote:s.default.oneOfType([s.default.number,s.default.string])};t.default=g},576:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.default=undefined;var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o=r(1);var a=s(o);var i=r(2);var u=s(i);function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function c(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function f(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var p=function(e){f(t,e);function t(){var e;var r,n,o;l(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=c(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n._onClick=function(){n._ref.click();n._ref.value=""},r),c(n,o)}n(t,[{key:"render",value:function e(){var t=this;var r=this.props,n=r.type,o=r.multiple,i=r.onChange;return a.default.createElement("span",{ref:"file",onClick:this._onClick},a.default.createElement("input",{type:"file",accept:n,ref:function e(r){t._ref=r},onChange:i,multiple:o,style:{display:"none"}}),this.props.children)}}]);return t}(o.Component);t.default=p;p.propTypes={type:u.default.string.isRequired,multiple:u.default.bool.isRequired,onChange:u.default.func.isRequired}},593:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.addMarkPostApi=u;t.deleteMarkPostApi=s;t.getMarkPostsBySubdomain=l;t.getAllMarkPosts=c;var n=r(202);var o=i(n);var a=r(136);function i(e){return e&&e.__esModule?e:{default:e}}function u(e){var t=a.MERCHANT_API_URL+("v1/user/bookmark/post/"+e);return o.default.post(t)}function s(e){var t=a.MERCHANT_API_URL+("v1/user/bookmark/post/"+e);return o.default.delete(t)}function l(e){var t=a.MERCHANT_API_URL+("v1/user/bookmark/by-sub-domain/after/"+e);return o.default.get(t)}function c(e){var t=a.MERCHANT_API_URL+("v1/user/bookmark/after/"+e);return o.default.get(t)}},602:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(580);var o=N(n);var a=r(536);var i=N(a);var u=r(557);var s=N(u);var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var c;r(601);r(538);r(556);var f=r(1);var p=N(f);var d=r(2);var v=N(d);var m=r(547);var h=N(m);var b=r(198);var y=N(b);var g=r(532);var _=r(533);var w=N(_);var E=r(530);var P=r(92);var O=r(671);var C=N(O);var k=r(523);var j=r(668);var M=N(j);var x=r(667);var I=N(x);var A=r(199);var T=r(527);var R=r(529);var D=r(535);function N(e){return e&&e.__esModule?e:{default:e}}function V(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function S(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function z(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function L(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var U=y.default.bind(h.default);var H=(0,k.observer)(c=function(e){L(t,e);function t(e){S(this,t);var r=z(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));r._onFocus=function(){r.store.setFocusEditor(true)};r._onBlur=function(){r.store.setFocusEditor(false)};r._checkEmpty=function(){if(r._ref.innerHTML=="<br>"){r._ref.innerHTML=""}};r.renderMessageError=function(e){return p.default.createElement(s.default,{style:{marginTop:20,marginBottom:20},message:e,type:"error",showIcon:true})};r.clearData=function(){r._ref.innerHTML="";r.store.reset()};r.uploadPostSuccess=function(e){var t=r.props.post;r.clearData();r._onBlur();var n=!(0,A.isEmpty)((0,A.getValueObjectFromStringKey)(t,"id"));if(n){r.props.editPost(e)}else{r.props.addPost(e)}};r.submitAddPost=function(){r.store.addPost(r.uploadPostSuccess)};r.submitEditPost=function(){r.store.editPost(r.uploadPostSuccess)};r.onSelectImageToUpload=function(e){var t=r.props.t;var n=r.store.images;var o=Array.from(e);if(o.length+n.length>10){(0,R.messageWarning)(t("social.editor.noti.limit_file_upload"));o=o.slice(0,10-n.length)}if(o.length<=0)return;o=o.map(function(e){return{file:e}});r.store.addImages(o)};r.renderSubmit=function(){var e=r.props,t=e.t,n=e.post,o=e.account;var a=!(0,A.isEmpty)((0,A.getValueObjectFromStringKey)(n,"id"));var u=o.joined,s=o.isJoining,l=o.onJoin;if((0,T.isLoggedIn)()){if(!u){return p.default.createElement(i.default,{type:"primary",loading:s,onClick:s?null:l,style:{width:"100%"}},t("social.editor.form.button_join_to_post"))}if(a){return p.default.createElement(i.default,{type:"primary",onClick:r.submitEditPost,style:{width:"100%"}},t("social.editor.form.button_edit_post"))}return p.default.createElement(i.default,{type:"primary",onClick:r.submitAddPost,style:{width:"100%"}},t("social.editor.form.button_post"))}else{return p.default.createElement(i.default,{type:"primary",onClick:function e(){(0,T.redirectSignIn)()},style:{width:"100%"}},t("social.editor.form.button_signin_to_post"))}};r.handlePaste=function(e){e.stopPropagation();e.preventDefault();var t=e.clipboardData||window.clipboardData;var n=t.getData("text/plain");n=(0,D.convertDataPastedEditor)(n);document.execCommand("insertHtml",false,n);r.setContent()};r.setContent=function(){setTimeout(function(){r.store.setContent(r._ref.innerHTML);r.store.setLineNumber(r._ref.childElementCount)},100)};r.onKeyPress=function(){r._checkEmpty();r.setContent()};r.getPlaceHolderEditor=function(){var e=r.props,t=e.account,n=e.t;var o=t.joined;var a=(0,T.isLoggedIn)()?n("social.editor.form.placeholder"):n("social.editor.form.placeholder_need_signin");a=o?a:n("social.editor.form.placeholder_need_join");return a};r.store=new C.default(e.post);if(e.post){r.defaultValue=(0,D.convertDataBeforeAddEditor)(e.post.body);r._onFocus()}else{r.defaultValue=""}return r}l(t,[{key:"render",value:function e(){var t=this;var r=this.props,n=r.account,a=r.prefixCls;var i=n.acceptAction;var u=this.store,s=u.isFocus,l=u.percentUpload,c=u.error,f=u.isUploading,d=u.images,v=u.isZoomText;var m=n&&n.avatar_url?n.avatar_url:E.LOGO;var h=this.getPlaceHolderEditor();return p.default.createElement("div",{className:U(a+"-layout-editor",V({},a+"-disable",f))},p.default.createElement("div",{className:U(a+"-container")},p.default.createElement(w.default,{url:m,size:40}),p.default.createElement("div",{className:U(a+"-editor",V({},a+"-zoom-text",s&&v)),contentEditable:!f,onFocus:this._onFocus,ref:function e(r){t._ref=r},onPaste:this.handlePaste,placeholder:h,onKeyUp:this.onKeyPress,dangerouslySetInnerHTML:{__html:this.defaultValue}})),!(0,A.isEmptyArr)(d)&&p.default.createElement(I.default,{images:d,store:this.store,onSelectImageToUpload:this.onSelectImageToUpload}),s&&i&&p.default.createElement("div",null,p.default.createElement("div",{className:U(a+"-divider",a+"-horizontal")}),p.default.createElement(M.default,{onSelectImageToUpload:this.onSelectImageToUpload})),c&&this.renderMessageError(c),s&&p.default.createElement("div",{className:U(a+"-container-action")},f?p.default.createElement(o.default,{percent:l*100,status:"active",showInfo:false}):this.renderSubmit()))}}]);return t}(p.default.Component))||c;H.defaultProps={prefixCls:"editor-post"};H.propTypes={addPost:v.default.func,editPost:v.default.func,post:v.default.object};t.default=(0,P.translate)(function(e){return e.namespaces})((0,g.withAccount)(H))},630:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var a,i,u,s,l,c,f,p,d,v;var m=r(525);var h=r(554);var b=r(526);var y=r(535);function g(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,a){try{var i=t[o](a);var u=i.value}catch(e){r(e);return}if(i.done){e(u)}else{return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}function _(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function w(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function E(e,t,r,n,o){var a={};Object["ke"+"ys"](n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(o&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(o):void 0;a.initializer=undefined}if(a.initializer===void 0){Object["define"+"Property"](e,t,a);a=null}return a}function P(e,t){throw new Error("Decorating class property failed. Please ensure that transform-class-properties is enabled.")}var O=(u=function(){function e(t){w(this,e);_(this,"comment",s,this);_(this,"isVoting",l,this);_(this,"isViewMore",c,this);_(this,"addUpVoteComment",f,this);_(this,"addDownVoteComment",p,this);_(this,"removeVoteComment",d,this);_(this,"changeDataComment",v,this);this.comment=t}o(e,[{key:"upVote",value:function(){var e=g(regeneratorRuntime.mark(function e(){var t,r,o,a,i;return regeneratorRuntime.wrap(function e(u){while(1){switch(u.prev=u.next){case 0:if(!this.isVoting){u.next=2;break}return u.abrupt("return");case 2:this.isVoting=true;t=this.comment;r=t.id;o=n({},t);if(t.vote==1){this.removeVoteComment()}else{this.addUpVoteComment()}u.prev=7;u.next=10;return(0,h.upVoteApi)(r);case 10:a=u.sent;i=a.data;if((0,b.httpSuccess)(a.status)){this.changeDataComment(i.data)}else{this.changeDataComment(o)}u.next=18;break;case 15:u.prev=15;u.t0=u["catch"](7);this.changeDataComment(o);case 18:u.prev=18;this.isVoting=false;return u.finish(18);case 21:case"end":return u.stop()}}},e,this,[[7,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"downVote",value:function(){var e=g(regeneratorRuntime.mark(function e(){var t,r,o,a,i;return regeneratorRuntime.wrap(function e(u){while(1){switch(u.prev=u.next){case 0:if(!this.isVoting){u.next=2;break}return u.abrupt("return");case 2:this.isVoting=true;t=this.comment;r=t.id;o=n({},t);if(t.vote==-1){this.removeVoteComment()}else{this.addDownVoteComment()}u.prev=7;u.next=10;return(0,h.downVoteApi)(r);case 10:a=u.sent;i=a.data;if((0,b.httpSuccess)(a.status)){this.changeDataComment(i.data)}else{this.changeDataComment(o)}u.next=18;break;case 15:u.prev=15;u.t0=u["catch"](7);this.changeDataComment(o);case 18:u.prev=18;this.isVoting=false;return u.finish(18);case 21:case"end":return u.stop()}}},e,this,[[7,15,18,21]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"disableViewMore",value:function e(){this.isViewMore=false}},{key:"content",get:function e(){if(this.viewMore){return(0,y.splitStrToViewMore)(this.comment.value)}else{return this.comment.value}}},{key:"viewMore",get:function e(){return((0,y.isViewMore)(this.comment.value)||(0,y.overLineNumber)(this.comment.value))&&this.isViewMore}}]);return e}(),s=E(u.prototype,"comment",[m.observable],{enumerable:true,initializer:function e(){return{}}}),l=E(u.prototype,"isVoting",[m.observable],{enumerable:true,initializer:function e(){return false}}),c=E(u.prototype,"isViewMore",[m.observable],{enumerable:true,initializer:function e(){return true}}),E(u.prototype,"upVote",[m.action],Object.getOwnPropertyDescriptor(u.prototype,"upVote"),u.prototype),E(u.prototype,"downVote",[m.action],Object.getOwnPropertyDescriptor(u.prototype,"downVote"),u.prototype),f=E(u.prototype,"addUpVoteComment",[m.action],{enumerable:true,initializer:function e(){var t=this;return function(){var e=t.comment;if(e.vote===0){e.upvote++}else if(e.vote===-1){e.upvote++;e.downvote--}e.vote=1}}}),p=E(u.prototype,"addDownVoteComment",[m.action],{enumerable:true,initializer:function e(){var t=this;return function(){var e=t.comment;if(e.vote==0){e.downvote++}else if(e.vote==1){e.upvote--;e.downvote++}e.vote=-1}}}),d=E(u.prototype,"removeVoteComment",[m.action],{enumerable:true,initializer:function e(){var t=this;return function(){var e=t.comment;if(e.vote==1){e.upvote--}else if(e.vote==-1){e.downvote--}e.vote=0}}}),v=E(u.prototype,"changeDataComment",[m.action],{enumerable:true,initializer:function e(){var t=this;return function(e,r){t.comment=n({},t.comment,r)}}}),E(u.prototype,"content",[m.computed],Object.getOwnPropertyDescriptor(u.prototype,"content"),u.prototype),E(u.prototype,"disableViewMore",[m.action],Object.getOwnPropertyDescriptor(u.prototype,"disableViewMore"),u.prototype),E(u.prototype,"viewMore",[m.computed],Object.getOwnPropertyDescriptor(u.prototype,"viewMore"),u.prototype),u);t.default=O},631:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o,a,i,u,s,l,c,f;var p=r(525);var d=r(554);var v=r(526);var m=r(199);var h=r(630);var b=_(h);var y=r(529);var g=r(541);function _(e){return e&&e.__esModule?e:{default:e}}function w(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function E(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,a){try{var i=t[o](a);var u=i.value}catch(e){r(e);return}if(i.done){e(u)}else{return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}function P(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function C(e,t,r,n,o){var a={};Object["ke"+"ys"](n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(o&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(o):void 0;a.initializer=undefined}if(a.initializer===void 0){Object["define"+"Property"](e,t,a);a=null}return a}function k(e,t){throw new Error("Decorating class property failed. Please ensure that transform-class-properties is enabled.")}var j=(i=function(){function e(t){var r=this;O(this,e);this.post=null;P(this,"comments",u,this);P(this,"isLoading",s,this);P(this,"error",l,this);P(this,"pagination",c,this);P(this,"addComment",f,this);this.isExistedComment=function(e){return(0,m.isExistArray)(r.comments,e,"id",function(t){return t.comment.id==e.id})};this.post=t}n(e,[{key:"getComments",value:function(){var e=E(regeneratorRuntime.mark(function e(t){var r=this;var n,o,a,i,u,s;return regeneratorRuntime.wrap(function e(l){while(1){switch(l.prev=l.next){case 0:n=this.post.id;this.isLoading=true;this.error=null;l.prev=3;o=(0,m.getFirstArr)(this.comments);a=o?o.comment.id:"";l.next=8;return(0,d.getCommentsApi)(n,a,t);case 8:i=l.sent;u=i.data;if((0,v.httpSuccess)(i.status)){s=u.data;s=this.createStoreComments(s);(0,p.runInAction)(function(){r.comments=(0,g.concat2Array)(s.reverse(),r.comments);u.meta.remain_total=u.meta.total-s.length;r.pagination=u.meta})}else{(0,p.runInAction)(function(){r.error=(0,v.messageHttpRequest)()})}l.next=16;break;case 13:l.prev=13;l.t0=l["catch"](3);(0,p.runInAction)(function(){r.error=(0,v.messageHttpRequest)(l.t0)});case 16:l.prev=16;(0,p.runInAction)(function(){r.isLoading=false});if(!(0,m.isEmpty)(this.error)){(0,y.messageError)(this.error)}return l.finish(16);case 20:case"end":return l.stop()}}},e,this,[[3,13,16,20]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"createStoreComments",value:function e(t){var r=this;return t.map(function(e){return r.createStoreComment(e)})}},{key:"createStoreComment",value:function e(t){return new b.default(t)}},{key:"isLoadMore",get:function e(){return this.pagination.remain_total>0}}]);return e}(),u=C(i.prototype,"comments",[p.observable],{enumerable:true,initializer:function e(){return[]}}),s=C(i.prototype,"isLoading",[p.observable],{enumerable:true,initializer:function e(){return false}}),l=C(i.prototype,"error",[p.observable],{enumerable:true,initializer:function e(){return null}}),c=C(i.prototype,"pagination",[p.observable],{enumerable:true,initializer:function e(){return{}}}),C(i.prototype,"getComments",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"getComments"),i.prototype),f=C(i.prototype,"addComment",[p.action],{enumerable:true,initializer:function e(){var t=this;return function(e){t.comments=[].concat(w(t.comments),[t.createStoreComment(e)])}}}),C(i.prototype,"isLoadMore",[p.computed],Object.getOwnPropertyDescriptor(i.prototype,"isLoadMore"),i.prototype),i);t.default=j},632:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o,a,i,u,s,l,c,f;var p=r(525);var d=r(526);var v=r(554);var m=r(529);var h=r(535);function b(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,a){try{var i=t[o](a);var u=i.value}catch(e){r(e);return}if(i.done){e(u)}else{return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}function y(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function g(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function _(e,t,r,n,o){var a={};Object["ke"+"ys"](n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(o&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(o):void 0;a.initializer=undefined}if(a.initializer===void 0){Object["define"+"Property"](e,t,a);a=null}return a}function w(e,t){throw new Error("Decorating class property failed. Please ensure that transform-class-properties is enabled.")}var E=(i=function(){function e(t){g(this,e);this.post=null;y(this,"isUploading",u,this);y(this,"error",s,this);y(this,"isFocus",l,this);y(this,"content",c,this);y(this,"setFocusEditor",f,this);this.post=t}n(e,[{key:"addComment",value:function(){var e=b(regeneratorRuntime.mark(function e(t){var r=this;var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;var o,a,i;return regeneratorRuntime.wrap(function e(u){while(1){switch(u.prev=u.next){case 0:o=this.post.id;this.isUploading=true;this.error=null;u.prev=3;u.next=6;return(0,v.addCommentApi)(o,t);case 6:a=u.sent;i=a.data;if((0,d.httpSuccess)(a.status)){if(n){n(i.data)}}else{(0,p.runInAction)(function(){r.error=(0,d.messageHttpRequest)()})}u.next=14;break;case 11:u.prev=11;u.t0=u["catch"](3);(0,p.runInAction)(function(){r.error=(0,d.messageHttpRequest)(u.t0)});case 14:u.prev=14;(0,p.runInAction)(function(){r.isUploading=false});if(this.error){(0,m.messageError)(this.error)}return u.finish(14);case 18:case"end":return u.stop()}}},e,this,[[3,11,14,18]])}));function t(t){return e.apply(this,arguments)}return t}()},{key:"reset",value:function e(){this.isUploading=false;this.error=null;this.isFocus=false;this.content=""}},{key:"setContent",value:function e(t){this.content=(0,h.convertDataEditor)(t)}},{key:"setLineNumber",value:function e(t){this.lineNumber=t}}]);return e}(),u=_(i.prototype,"isUploading",[p.observable],{enumerable:true,initializer:function e(){return false}}),s=_(i.prototype,"error",[p.observable],{enumerable:true,initializer:function e(){return null}}),l=_(i.prototype,"isFocus",[p.observable],{enumerable:true,initializer:function e(){return false}}),c=_(i.prototype,"content",[p.observable],{enumerable:true,initializer:function e(){return""}}),_(i.prototype,"addComment",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"addComment"),i.prototype),f=_(i.prototype,"setFocusEditor",[p.action],{enumerable:true,initializer:function e(){var t=this;return function(e){t.isFocus=e}}}),_(i.prototype,"reset",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"reset"),i.prototype),_(i.prototype,"setContent",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"setContent"),i.prototype),_(i.prototype,"setLineNumber",[p.action],Object.getOwnPropertyDescriptor(i.prototype,"setLineNumber"),i.prototype),i);t.default=E},635:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(548);var o=u(n);t.showDeleteConfirm=s;t.showWarningConfirm=l;r(549);var a=r(199);var i=r(200);function u(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var r=arguments[2];var n=arguments[3];var u=arguments[4];var s=arguments[5];o.default.confirm({title:(0,a.isEmpty)(e)?(0,i.translateI18n)("social.global.are_you_sure_delete"):e,content:t,okText:(0,a.isEmpty)(u)?(0,i.translateI18n)("social.global.yes"):u,okType:"danger",cancelText:(0,a.isEmpty)(s)?(0,i.translateI18n)("social.global.no"):s,onOk:function e(){if(r){r()}},onCancel:function e(){if(n){n()}}})}function l(e){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var r=arguments[2];var n=arguments[3];var u=arguments[4];var s=arguments[5];o.default.confirm({title:(0,a.isEmpty)(e)?(0,i.translateI18n)("social.global.are_you_sure"):e,content:t,okText:(0,a.isEmpty)(u)?(0,i.translateI18n)("social.global.yes"):u,okType:"danger",cancelText:(0,a.isEmpty)(s)?(0,i.translateI18n)("social.global.no"):s,onOk:function e(){if(r){r()}},onCancel:function e(){if(n){n()}}})}},636:function(e,t){},642:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(1);var o=p(n);var a=r(198);var i=p(a);var u=r(542);var s=p(u);var l=r(537);var c=r(546);var f=p(c);function p(e){return e&&e.__esModule?e:{default:e}}var d=i.default.bind(f.default);var v=function e(t){var r=t.prefixCls;return o.default.createElement("div",null,o.default.createElement("div",{className:d(r+"-layout-content")},o.default.createElement(l.RoundShape,{color:"#E0E0E0",style:{width:30,height:30}}),o.default.createElement("div",{className:d(r+"-content")},o.default.createElement("div",{className:d(r+"-comment")},o.default.createElement(l.TextBlock,{rows:2,color:"#E0E0E0"})))))};v.defaultProps={prefixCls:"post-comment"};t.default=(0,s.default)()(v)},643:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o;var a=r(1);var i=g(a);var u=r(2);var s=g(u);var l=r(546);var c=g(l);var f=r(198);var p=g(f);var d=r(523);var v=r(573);var m=g(v);var h=r(562);var b=r(92);var y=r(527);function g(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function w(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function E(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var P=p.default.bind(c.default);var O=(0,d.observer)(o=function(e){E(t,e);function t(){var e;var r,n,o;_(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.handleUpVote=function(){var e=n.props.store;e.upVote()},n.handleDownVote=function(){var e=n.props.store;e.downVote()},r),w(n,o)}n(t,[{key:"render",value:function e(){var t=this.props,r=t.comment,n=t.prefixCls;var o=!(0,y.isLoggedIn)();return i.default.createElement("div",{className:P(n+"-layout-action")},i.default.createElement("div",{className:P(n+"-action-left")},i.default.createElement(m.default,{upvote:r.upvote,downvote:r.downvote,vote:r.vote,actionUpVote:this.handleUpVote,actionDownVote:this.handleDownVote,disabled:o})),i.default.createElement("div",{className:P(n+"-action-right")},i.default.createElement("div",{className:P(n+"-text-time")},(0,h.fullRelativeTime)(r.created_at))))}}]);return t}(i.default.Component))||o;O.defaultProps={prefixCls:"post-comment"};O.propTypes={comment:s.default.object,store:s.default.object.isRequired};t.default=(0,b.translate)(function(e){return e.namespaces})(O)},644:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o;var a=r(1);var i=E(a);var u=r(2);var s=E(u);var l=r(546);var c=E(l);var f=r(198);var p=E(f);var d=r(523);var v=r(533);var m=E(v);var h=r(530);var b=r(643);var y=E(b);var g=r(199);var _=r(540);var w=r(92);function E(e){return e&&e.__esModule?e:{default:e}}function P(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function O(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function C(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var k=p.default.bind(c.default);var j=(0,d.observer)(o=function(e){C(t,e);function t(){var e;var r,n,o;P(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=O(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.handleViewMore=function(){var e=n.props.store;e.disableViewMore()},r),O(n,o)}n(t,[{key:"render",value:function e(){var t=this.props,r=t.store,n=t.prefixCls,o=t.t;var a=r.comment;var u=a.user?a.user:{avatar_url:h.LOGO};var s=(0,g.linkRoute)("/profile/:userID",{userID:(0,g.getValueObjectFromStringKey)(a,"user.id")});var l=r.content;var c=r.viewMore;return i.default.createElement("div",{className:k(n+"-layout-content")},i.default.createElement(m.default,{url:u.avatar_url}),i.default.createElement("div",{className:k(n+"-content")},i.default.createElement("div",{className:k(n+"-comment")},i.default.createElement(_.Link,{to:s},i.default.createElement("div",{className:k(n+"-name")},u.name)),i.default.createElement("div",{className:k(n+"-content-comment"),dangerouslySetInnerHTML:{__html:l}}),c&&i.default.createElement("div",{className:k(n+"-content-view-more"),onClick:this.handleViewMore},o("social.home.post_item.view_more"))),i.default.createElement(y.default,{comment:a,store:r})))}}]);return t}(i.default.Component))||o;j.defaultProps={prefixCls:"post-comment"};j.propTypes={store:s.default.object.isRequired};t.default=(0,w.translate)(function(e){return e.namespaces})(j)},646:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o;var a=r(1);var i=_(a);var u=r(2);var s=_(u);var l=r(546);var c=_(l);var f=r(198);var p=_(f);var d=r(523);var v=r(644);var m=_(v);var h=r(642);var b=_(h);var y=r(92);var g=r(199);function _(e){return e&&e.__esModule?e:{default:e}}function w(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function E(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function P(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var O=p.default.bind(c.default);var C=(0,d.observer)(o=function(e){P(t,e);function t(){var e;var r,n,o;w(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=E(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.loadMore=function(){if(n.props.store.isLoadMore){n.props.store.getComments()}},r),E(n,o)}n(t,[{key:"componentDidMount",value:function e(){this.props.store.getComments(2)}},{key:"render",value:function e(){var t=this.props.store,r=t.comments,n=t.isLoading,o=t.isLoadMore;var a=this.props,u=a.t,s=a.prefixCls;return i.default.createElement("div",null,i.default.createElement("div",{className:O(s+"-container-comment")},o&&!(0,g.isEmptyArr)(r)&&i.default.createElement("div",{className:O(s+"-text-load-more"),onClick:this.loadMore},u("social.home.post.comment_load_more")),n&&i.default.createElement(b.default,null),!(0,g.isEmptyArr)(r)?r.map(function(e,t){return i.default.createElement(m.default,{store:e,key:t})}):n&&i.default.createElement("div",null,i.default.createElement(b.default,null))))}}]);return t}(i.default.Component))||o;C.defaultProps={prefixCls:"post-comment"};C.propTypes={store:s.default.object.isRequired};t.default=(0,y.translate)(function(e){return e.namespaces})(C)},648:function(e,t,r){e.exports={"editor-comment-layout-editor":"__2sA95t","editor-comment-container":"__1XXRmy","editor-comment-editor":"__2gHum7","editor-comment-border":"__2NlD2p","editor-comment-uploading-comment":"__1ai2ON","editor-comment-disable":"__1u--4X","editor-comment-uploading":"__16xzvA","editor-comment-signin-to-comment":"__1AIPB9"}},649:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(206);var o=j(n);var a=r(557);var i=j(a);var u=r(524);var s=j(u);var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var c;r(205);r(556);r(528);var f=r(1);var p=j(f);var d=r(2);var v=j(d);var m=r(648);var h=j(m);var b=r(198);var y=j(b);var g=r(532);var _=r(533);var w=j(_);var E=r(530);var P=r(92);var O=r(523);var C=r(527);var k=r(535);function j(e){return e&&e.__esModule?e:{default:e}}function M(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}function x(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function I(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function A(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var T=y.default.bind(h.default);var R=p.default.createElement(s.default,{type:"loading",style:{fontSize:24},spin:true});var D=(0,O.observer)(c=function(e){A(t,e);function t(){var e;var r,n,o;x(this,t);for(var a=arguments.length,u=Array(a),s=0;s<a;s++){u[s]=arguments[s]}return o=(r=(n=I(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n),n._onFocus=function(){var e=n.props.store;e.setFocusEditor(true)},n._onBlur=function(){var e=n.props.store;e.setFocusEditor(false)},n._checkEmpty=function(){if(n._ref.innerHTML=="<br>"){n._ref.innerHTML=""}},n.uploadSuccess=function(e){var t=n.props.store;n._onBlur();n._ref.innerHTML="";t.reset();n.props.addComment(e)},n.setContent=function(){var e=n.props.store;setTimeout(function(){e.setContent(n._ref.innerHTML);e.setLineNumber(n._ref.childElementCount)},100)},n.onKeyPress=function(e){var t=n.props.store;if(e.which===13&&!e.shiftKey){t.addComment({value:t.content},n.uploadSuccess);e.preventDefault()}n._checkEmpty();n.setContent()},n.handlePaste=function(e){e.stopPropagation();e.preventDefault();var t=e.clipboardData||window.clipboardData;var r=t.getData("text/plain");r=(0,k.convertDataPastedEditor)(r);document.execCommand("insertHtml",false,r);n.setContent()},n.renderMessageError=function(e){return p.default.createElement(i.default,{style:{marginTop:20,marginBottom:20},message:e,type:"error",showIcon:true})},n.renderEditor=function(){var e;var t=n.props,r=t.t,o=t.store,a=t.prefixCls,i=t.account;if(!(0,C.isLoggedIn)()){return p.default.createElement("div",{className:T(a+"-signin-to-comment"),onClick:function e(){(0,C.redirectSignIn)()}},r("social.editor_comment.form.button_signin_to_comment"))}var u=i.joined,s=i.isJoining,l=i.onJoin;if(!u){return p.default.createElement("div",{className:T(a+"-signin-to-comment"),onClick:s?null:l},r("social.editor_comment.form.button_join_to_comment"))}var c=o.isFocus,f=o.isUploading;return p.default.createElement("div",{className:T((e={},M(e,a+"-editor",true),M(e,a+"-focus",c),M(e,a+"-border",c||f),M(e,a+"-uploading-comment",f),M(e,a+"-disable",f),e)),contentEditable:!f,onFocus:n._onFocus,onBlur:n._onBlur,ref:function e(t){n._ref=t},placeholder:r("social.editor_comment.form.placeholder"),onKeyPress:n.onKeyPress,onPaste:n.handlePaste})},r),I(n,o)}l(t,[{key:"render",value:function e(){var t=this.props,r=t.account,n=t.style,a=t.store,i=t.prefixCls;var u=a.isUploading;var s=r&&r.avatar_url?r.avatar_url:E.LOGO;return p.default.createElement("div",{className:T(i+"-layout-editor"),style:n},p.default.createElement("div",{className:T(i+"-container")},p.default.createElement(w.default,{url:s,style:{cursor:"pointer"}}),this.renderEditor(),u&&p.default.createElement("div",{className:T(i+"-uploading")},p.default.createElement(o.default,{indicator:R}))))}}]);return t}(p.default.Component))||c;D.defaultProps={prefixCls:"editor-comment"};D.propTypes={addComment:v.default.func,store:v.default.object.isRequired,style:v.default.object};t.default=(0,P.translate)(function(e){return e.namespaces})((0,g.withAccount)(D))},650:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o;var a=r(1);var i=b(a);var u=r(2);var s=b(u);var l=r(523);var c=r(649);var f=b(c);var p=r(646);var d=b(p);var v=r(572);var m=b(v);var h=r(571);function b(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function g(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var w=(0,l.observer)(o=function(e){_(t,e);function t(){var e;var r,n,o;y(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.addComment=function(e){var t=n.props.storeComment;if(!t.isExistedComment(e)){t.addComment(e);n.props.incNumberComment()}},r),g(n,o)}n(t,[{key:"componentDidMount",value:function e(){var t=this;var r=this.props.post;var n=r.merchant.sub_domain+":"+h.CREATE_COMMENT;m.default.on(n,function(e){var n=e.comment;if(n.post_id==r.id){t.addComment(n)}})}},{key:"render",value:function e(){var t=this.props,r=t.storeComment,n=t.storeEditorComment,o=t.hideListComment,a=t.hideEditorComment;return i.default.createElement("div",null,!o&&i.default.createElement(d.default,{store:r}),!a&&i.default.createElement(f.default,{style:{marginTop:"10px"},store:n,addComment:this.addComment}))}}]);return t}(i.default.Component))||o;w.propTypes={storeComment:s.default.object.isRequired,storeEditorComment:s.default.object.isRequired,post:s.default.object.isRequired,hideListComment:s.default.bool,hideEditorComment:s.default.bool};t.default=w},652:function(e,t,r){e.exports={"action-vote-voted":"__3iweo_","action-vote-action-vote":"__2_yE92","action-vote-action-vote-horizontal":"__suvqrk","action-vote-text-vote":"__3slyml","action-vote-disabled":"__1HY90a"}},653:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(524);var o=P(n);var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i;r(528);var u=r(1);var s=P(u);var l=r(2);var c=P(l);var f=r(534);var p=P(f);var d=r(198);var v=P(d);var m=r(523);var h=r(200);var b=r(573);var y=P(b);var g=r(564);var _=P(g);var w=r(92);var E=r(532);function P(e){return e&&e.__esModule?e:{default:e}}function O(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function C(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function k(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}function j(e,t,r){if(t in e){Object.defineProperty(e,t,{value:r,enumerable:true,configurable:true,writable:true})}else{e[t]=r}return e}var M=v.default.bind(p.default);var x=function e(t){var r=t.totalComments,n=r===undefined?0:r,o=t.disabled,a=t.prefixCls;return s.default.createElement("div",{className:M(a+"-action-comment",j({},a+"-disabled",o))},s.default.createElement("div",{className:M(a+"-text-comment")},n),(0,h.translateI18n)("social.home.post_item.comment"))};var I=(0,m.observer)(i=function(e){k(t,e);function t(){var e;var r,n,o;O(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=C(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.handleUpVote=function(){var e=n.props.store;e.upVote()},n.handleDownVote=function(){var e=n.props.store;e.downVote()},r),C(n,o)}a(t,[{key:"render",value:function e(){var t=this.props,r=t.post,n=t.prefixCls,a=t.t,i=t.handleMark,u=t.account;var l=!u.acceptAction;return s.default.createElement("div",{className:M(n+"-layout-action")},s.default.createElement("div",{className:M(n+"-action-left")},s.default.createElement(y.default,{upvote:r.upvote,downvote:r.downvote,vote:r.vote,actionUpVote:this.handleUpVote,actionDownVote:this.handleDownVote,disabled:l}),s.default.createElement("div",{className:M(n+"-divider",n+"-vertical")}),s.default.createElement(x,{totalComments:r.num_comments,disabled:l})),s.default.createElement("div",{className:M(n+"-action-right",j({},n+"-disabled",l))},s.default.createElement(_.default,{title:a("social.home.post_item.mark")},s.default.createElement(o.default,{type:"star",className:M(j({},n+"-active-mark",r.isBookmarked)),onClick:l?null:i}))))}}]);return t}(s.default.Component))||i;I.defaultProps={prefixCls:"post"};x.defaultProps={prefixCls:"post"};I.propTypes={post:c.default.object,store:c.default.object,handleMark:c.default.func};x.propTypes={totalComments:c.default.number};t.default=(0,w.translate)(function(e){return e.namespaces})((0,E.withAccount)(I))},655:function(e,t,r){},657:function(e,t,r){},658:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(524);var o=d(n);var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();r(528);var u=r(1);var s=d(u);var l=r(2);var c=d(l);var f=r(729);var p=d(f);r(657);r(655);function d(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function m(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function h(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var b=function e(t){var r=t.onClick;return s.default.createElement("div",{className:"container-next"},s.default.createElement("div",{className:"next",onClick:r},s.default.createElement(o.default,{type:"right",style:{fontSize:"40px"}})))};var y=function e(t){var r=t.onClick;return s.default.createElement("div",{className:"container-prev"},s.default.createElement("div",{className:"prev",onClick:r},s.default.createElement(o.default,{type:"left",style:{fontSize:"40px"}})))};var g=function(e){h(t,e);function t(e,r){v(this,t);return m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}i(t,[{key:"render",value:function e(){return s.default.createElement(p.default,a({nextArrow:s.default.createElement(b,null),prevArrow:s.default.createElement(y,null)},this.props.settings),this.props.children)}}]);return t}(s.default.Component);g.propTypes={settings:c.default.object.isRequired};t.default=g},659:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(548);var o=g(n);var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i;r(549);var u=r(1);var s=g(u);var l=r(2);var c=g(l);var f=r(534);var p=g(f);var d=r(198);var v=g(d);var m=r(523);var h=r(199);var b=r(658);var y=g(b);function g(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function w(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function E(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var P=v.default.bind(p.default);var O=(0,m.observer)(i=function(e){E(t,e);function t(){var e;var r,n,o;_(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.state={isReview:false,reviewImage:""},n.numberClick=0,n.handleCancel=function(){n.setState({isReview:false})},n.handleReviewImage=function(e){n.setState({reviewImage:e,isReview:true})},n.onDoubleClick=function(e){if(n.numberClick===1){n.handleReviewImage(e)}else{if(n.numberClick===0){n.numberClick=1;setTimeout(function(){n.numberClick=0},250)}}},r),w(n,o)}a(t,[{key:"render",value:function e(){var t=this;var r=this.props,n=r.images,a=r.prefixCls;if((0,h.isEmptyArr)(n)){return s.default.createElement("div",null)}else{var i={dots:true,infinite:true,speed:500,slidesToShow:1,slidesToScroll:1};var u=this.state,l=u.isReview,c=u.reviewImage;return s.default.createElement("div",{className:P(a+"-layout-image"),style:{marginBottom:n.length>1?"40px":0}},s.default.createElement(y.default,{settings:i},n.map(function(e,r){return s.default.createElement("div",{key:r},s.default.createElement("div",{className:P(a+"-image"),onClick:function r(){return t.onDoubleClick(e.url)},style:{background:(0,h.convertUrlImageBackground)(e.url)}}))})),s.default.createElement(o.default,{visible:l,footer:null,onCancel:this.handleCancel,bodyStyle:{padding:0},width:800},s.default.createElement("img",{style:{width:"100%"},src:c})))}}}]);return t}(s.default.Component))||i;O.defaultProps={prefixCls:"post"};O.propTypes={images:c.default.array.isRequired};t.default=O},660:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var o;var a=r(1);var i=b(a);var u=r(2);var s=b(u);var l=r(534);var c=b(l);var f=r(198);var p=b(f);var d=r(523);var v=r(659);var m=b(v);var h=r(92);function b(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function g(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function _(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var w=p.default.bind(c.default);var E=(0,d.observer)(o=function(e){_(t,e);function t(){var e;var r,n,o;y(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=g(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.handleViewMore=function(){var e=n.props.store;e.disableViewMore()},r),g(n,o)}n(t,[{key:"render",value:function e(){var t=this;var r=this.props,n=r.post,o=r.prefixCls,a=r.store,u=r.t;var s=a.content;var l=a.viewMore;return i.default.createElement("div",{className:w(o+"-content")},i.default.createElement("div",{dangerouslySetInnerHTML:{__html:s},className:w(o+"-content-body"),ref:function e(r){t._ref=r}}),l&&i.default.createElement("div",{className:w(o+"-content-view-more"),onClick:this.handleViewMore},u("social.home.post_item.view_more")),i.default.createElement(m.default,{images:n.images}))}}]);return t}(i.default.Component))||o;E.defaultProps={prefixCls:"post"};E.propTypes={post:s.default.object.isRequired,store:s.default.object.isRequired};t.default=(0,h.translate)(function(e){return e.namespaces})(E)},664:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(692);var o=M(n);var a=r(524);var i=M(a);var u=r(689);var s=M(u);var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var c;r(731);r(528);r(730);var f=r(1);var p=M(f);var d=r(2);var v=M(d);var m=r(533);var h=M(m);var b=r(534);var y=M(b);var g=r(198);var _=M(g);var w=r(562);var E=r(540);var P=r(532);var O=r(523);var C=r(199);var k=r(92);var j=r(530);function M(e){return e&&e.__esModule?e:{default:e}}function x(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function I(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function A(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var T=_.default.bind(y.default);var R=(0,O.observer)(c=function(e){A(t,e);function t(){var e;var r,n,o;x(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=I(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.renderActionHeader=function(){var e=n.props,t=e.t,r=e.post,o=e.handleMark,a=e.handleDelete,i=e.handleEdit,u=e.account;var l=r.creator;var c=r.isBookmarked?t("social.home.post_item.dropdown_remove_bookmark"):t("social.home.post_item.dropdown_add_bookmark");var f=l&&l.id===u.id;return p.default.createElement(s.default,null,f&&p.default.createElement(s.default.Item,{key:"0",onClick:i},t("social.home.post_item.dropdown_edit")),f&&p.default.createElement(s.default.Item,{key:"1",onClick:a},t("social.home.post_item.dropdown_delete")),f&&p.default.createElement(s.default.Divider,null),p.default.createElement(s.default.Item,{key:"3",onClick:o},c))},r),I(n,o)}l(t,[{key:"render",value:function e(){var t=this.props,r=t.post,n=t.linkDetail,a=t.linkProfile,u=t.prefixCls,s=t.account;var l=(0,C.getValueObjectFromStringKey)(r,"creator.avatar_url")?(0,C.getValueObjectFromStringKey)(r,"creator.avatar_url"):j.LOGO;var c=(0,C.getValueObjectFromStringKey)(r,"creator.name")?(0,C.getValueObjectFromStringKey)(r,"creator.name"):j.LOGO;var f=(0,C.randomStr)();var d=!s.acceptAction;return p.default.createElement("div",{className:T(u+"-header")},p.default.createElement("div",{className:T(u+"-creator")},p.default.createElement(h.default,{url:l}),p.default.createElement("div",{className:T(u+"-creator-content")},p.default.createElement(E.Link,{to:a},p.default.createElement("div",{className:T(u+"-name")},c)),p.default.createElement(E.Link,{to:n},p.default.createElement("div",{className:T(u+"-text-time")},(0,w.relativeTime)(r.created_at))))),!d&&p.default.createElement("div",{className:T(u+"-action")},p.default.createElement("div",{className:T(u+"-action-dropdown"),id:"dropdown-"+f},p.default.createElement(o.default,{overlay:this.renderActionHeader(),trigger:["click"],placement:"bottomRight",getPopupContainer:function e(){return document.getElementById("dropdown-"+f)}},p.default.createElement(i.default,{type:"ellipsis",className:T(u+"-action-icon")})))))}}]);return t}(p.default.Component))||c;R.defaultProps={prefixCls:"post"};R.propTypes={post:v.default.object.isRequired,linkDetail:v.default.string.isRequired,linkProfile:v.default.string.isRequired,handleMark:v.default.func,handleDelete:v.default.func,handleEdit:v.default.func};t.default=(0,k.translate)(function(e){return e.namespaces})((0,P.withAccount)(R))},666:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(548);var o=w(n);var a=r(580);var i=w(a);var u=r(524);var s=w(u);var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var c;r(549);r(601);r(528);var f=r(1);var p=w(f);var d=r(2);var v=w(d);var m=r(547);var h=w(m);var b=r(198);var y=w(b);var g=r(523);var _=r(199);function w(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function P(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function O(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var C=y.default.bind(h.default);var k=(0,g.observer)(c=function(e){O(t,e);function t(){var e;var r,n,o;E(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=P(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.state={isReview:false,reviewImage:""},n.handleCancel=function(){n.setState({isReview:false})},n.handleReviewImage=function(e){n.setState({reviewImage:e,isReview:true})},n.renderAction=function(){var e=n.props,t=e.image,r=e.prefixCls,o=e.removeImage;var a=(0,_.isEmpty)(t.url)?"":t.url;return p.default.createElement("div",{className:C(r+"-image-action")},p.default.createElement("div",{className:C(r+"-image-action-view"),onClick:function e(){return n.handleReviewImage(a)}},p.default.createElement(s.default,{type:"eye-o"})),p.default.createElement("div",{className:C(r+"-image-action-remove"),onClick:function e(){return o(t)}},p.default.createElement(s.default,{type:"delete"})))},r),P(n,o)}l(t,[{key:"componentDidMount",value:function e(){var t=this.props,r=t.image,n=t.store;if((0,_.isEmpty)(r.url)){n.uploadImage(r)}}},{key:"render",value:function e(){var t=this.props,r=t.image,n=t.prefixCls;var a=this.state,u=a.isReview,s=a.reviewImage;var l=(0,_.isEmpty)(r.url)?"":r.url;return p.default.createElement("div",{className:C(n+"-container-image")},p.default.createElement("div",{className:C(n+"-image"),style:{background:(0,_.convertUrlImageBackground)(l)}},this.renderAction()),r.isUploading&&p.default.createElement("div",{className:C(n+"-loading")},p.default.createElement(i.default,{percent:r.percentComplete,size:"small",status:"active",showInfo:false})),p.default.createElement(o.default,{visible:u,footer:null,onCancel:this.handleCancel,bodyStyle:{padding:0},width:800},p.default.createElement("img",{style:{width:"100%"},src:s})))}}]);return t}(p.default.Component))||c;k.defaultProps={prefixCls:"editor-post"};k.propTypes={store:v.default.object.isRequired,image:v.default.object.isRequired,removeImage:v.default.func};t.default=k},667:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(524);var o=w(n);var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i;r(528);var u=r(1);var s=w(u);var l=r(2);var c=w(l);var f=r(547);var p=w(f);var d=r(198);var v=w(d);var m=r(92);var h=r(523);var b=r(666);var y=w(b);var g=r(576);var _=w(g);function w(e){return e&&e.__esModule?e:{default:e}}function E(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function P(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function O(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var C=v.default.bind(p.default);var k=(0,h.observer)(i=function(e){O(t,e);function t(){var e;var r,n,a;E(this,t);for(var i=arguments.length,u=Array(i),l=0;l<i;l++){u[l]=arguments[l]}return a=(r=(n=P(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(u))),n),n.onSelectImage=function(e){var t=n.props.onSelectImageToUpload;t(e.target.files)},n.removeImage=function(e){var t=n.props.store;t.removeImage(e)},n.renderAddImage=function(){var e=n.props.prefixCls;return s.default.createElement("div",{className:C(e+"-container-image")},s.default.createElement(_.default,{type:".jpg,.png,.gif",multiple:true,onChange:n.onSelectImage},s.default.createElement("div",{className:C(e+"-image-add")},s.default.createElement(o.default,{type:"plus-circle-o"}))))},r),P(n,a)}a(t,[{key:"render",value:function e(){var t=this;var r=this.props,n=r.store,o=r.images,a=r.prefixCls;return s.default.createElement("div",{className:C(a+"-layout-image")},s.default.createElement("div",{className:C(a+"-scrollable")},o.map(function(e,r){return s.default.createElement(y.default,{key:r,store:n,image:e,removeImage:t.removeImage})}),this.renderAddImage()))}}]);return t}(s.default.Component))||i;k.defaultProps={prefixCls:"editor-post"};k.propTypes={store:c.default.object.isRequired,images:c.default.array.isRequired,onSelectImageToUpload:c.default.func};t.default=(0,m.translate)(function(e){return e.namespaces})(k)},668:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=r(536);var o=g(n);var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var i;r(538);var u=r(1);var s=g(u);var l=r(2);var c=g(l);var f=r(547);var p=g(f);var d=r(198);var v=g(d);var m=r(92);var h=r(523);var b=r(576);var y=g(b);function g(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function w(e,t){if(!e){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t&&(typeof t==="object"||typeof t==="function")?t:e}function E(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});if(t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}var P=v.default.bind(p.default);var O=(0,h.observer)(i=function(e){E(t,e);function t(){var e;var r,n,o;_(this,t);for(var a=arguments.length,i=Array(a),u=0;u<a;u++){i[u]=arguments[u]}return o=(r=(n=w(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),n),n.onSelectImage=function(e){var t=n.props.onSelectImageToUpload;t(e.target.files)},r),w(n,o)}a(t,[{key:"render",value:function e(){var t=this.props,r=t.t,n=t.prefixCls;return s.default.createElement("div",{className:P(n+"-layout-action")},s.default.createElement("div",{className:P(n+"-action-photo")},s.default.createElement(y.default,{type:".jpg,.png,.gif",multiple:true,onChange:this.onSelectImage},s.default.createElement(o.default,{icon:"picture"},r("social.editor.action.photo")))))}}]);return t}(s.default.Component))||i;O.defaultProps={prefixCls:"editor-post"};O.propTypes={onSelectImageToUpload:c.default.func.isRequired};t.default=(0,m.translate)(function(e){return e.namespaces})(O)},669:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});t.uploadImageApi=a;var n=r(136);var o=r(527);function a(e,t,r,a){var i=n.MERCHANT_API_URL+"v1/image";var u=new FormData;u.append("image",e);var s=new XMLHttpRequest;s.addEventListener("load",t,false);s.upload.onprogress=r;s.addEventListener("error",a,false);s.open("POST",i);s.setRequestHeader("Authorization","Bearer "+(0,o.getToken)());s.send(u)}},670:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};function o(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var a=function e(t,r,n){if(t<r)return r;if(t>n)return n;return t};var i=function e(){var t=this;o(this,e);this.minimum=.08;this.value=null;this.callbackValue=null;this.config={trickle:true,trickleRate:.02,trickleSpeed:800};this.init=function(e){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};t.config=n({},t.config,r);t.callbackValue=e};this.start=function(){if(!t.value)t.set(0);if(t.config.trickle){t.run=setInterval(function(){if(!t.isInited)return;t.trickle()},t.config.trickleSpeed)}};this.inc=function(e){var r=t.value;if(!r){return t.start()}else{if(typeof e!=="number"){e=(1-r)*a(Math.random()*r,.1,.95)}r=a(r+e,0,.994);return t.set(r)}};this.trickle=function(){t.inc(Math.random()*t.config.trickleRate)};this.set=function(e){if(e<=t.minimum){t.value=t.minimum}else{t.value=e}if(!t.isInited)return;t.callbackValue(t.value)};this.isInited=function(){return t.callbackValue};this.done=function(){t.value=1;if(!t.isInited)return;t.callbackValue(t.value);if(t.run){clearInterval(t.run)}}};t.default=new i},671:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r){if(Object.prototype.hasOwnProperty.call(r,n)){e[n]=r[n]}}}return e};var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(e,n.key,n)}}return function(t,r,n){if(r)e(t.prototype,r);if(n)e(t,n);return t}}();var a,i,u,s,l,c,f,p,d,v,m,h,b;var y=r(525);var g=r(526);var _=r(550);var w=r(670);var E=M(w);var P=r(200);var O=r(669);var C=r(529);var k=r(535);var j=r(199);function M(e){return e&&e.__esModule?e:{default:e}}function x(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(o,a){try{var i=t[o](a);var u=i.value}catch(e){r(e);return}if(i.done){e(u)}else{return Promise.resolve(u).then(function(e){n("next",e)},function(e){n("throw",e)})}}return n("next")})}}function I(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++){r[t]=e[t]}return r}else{return Array.from(e)}}function A(e,t,r,n){if(!r)return;Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function T(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function R(e,t,r,n,o){var a={};Object["ke"+"ys"](n).forEach(function(e){a[e]=n[e]});a.enumerable=!!a.enumerable;a.configurable=!!a.configurable;if("value"in a||a.initializer){a.writable=true}a=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},a);if(o&&a.initializer!==void 0){a.value=a.initializer?a.initializer.call(o):void 0;a.initializer=undefined}if(a.initializer===void 0){Object["define"+"Property"](e,t,a);a=null}return a}function D(e,t){throw new Error("Decorating class property failed. Please ensure that transform-class-properties is enabled.")}var N=(u=function(){function e(t){var r=this;T(this,e);A(this,"percentUpload",s,this);A(this,"isUploading",l,this);A(this,"error",c,this);A(this,"isFocus",f,this);A(this,"images",p,this);A(this,"content",d,this);A(this,"lineNumber",v,this);this.post={};A(this,"setFocusEditor",m,this);A(this,"addImages",h,this);A(this,"changeDataImages",b,this);this.getImageByFile=function(e){return r.images.filter(function(t){return e===t.file})[0]};this.getIndexImagesByFile=function(e){return r.images.indexOf(r.getImageByFile(e))};this.getIdImages=function(){return r.images.map(function(e){return e.id})};if(!(0,j.isEmpty)(t)){this.post=t;this.content=t.body;this.images=[].concat(I(t.images))}}o(e,[{key:"addPost",value:function(){var e=x(regeneratorRuntime.mark(function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var n,o,a;return regeneratorRuntime.wrap(function e(i){while(1){switch(i.prev=i.next){case 0:this.isUploading=true;this.error=null;E.default.init(function(e){t.percentUpload=e},{trickleRate:.1,trickleSpeed:500});E.default.set(0);E.default.start();n={body:this.content,image_ids:JSON.stringify(this.getIdImages())};i.prev=6;i.next=9;return(0,_.addPostApi)(n);case 9:o=i.sent;a=o.data;if((0,g.httpSuccess)(o.status)){setTimeout(function(){(0,y.runInAction)(function(){t.isUploading=false});(0,C.messageSuccess)((0,P.translateI18n)("social.home.post.upload_success"));if(r){r(a.data)}},400)}else{(0,y.runInAction)(function(){t.error=(0,g.messageHttpRequest)();t.isUploading=false})}i.next=17;break;case 14:i.prev=14;i.t0=i["catch"](6);(0,y.runInAction)(function(){t.error=(0,g.messageHttpRequest)(i.t0);t.isUploading=false});case 17:i.prev=17;E.default.done();return i.finish(17);case 20:case"end":return i.stop()}}},e,this,[[6,14,17,20]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"editPost",value:function(){var e=x(regeneratorRuntime.mark(function e(){var t=this;var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var o,a,i;return regeneratorRuntime.wrap(function e(u){while(1){switch(u.prev=u.next){case 0:this.isUploading=true;this.error=null;E.default.init(function(e){t.percentUpload=e},{trickleRate:.1,trickleSpeed:500});E.default.set(0);E.default.start();o=n({},this.post,{body:this.content,image_ids:JSON.stringify(this.getIdImages())});u.prev=6;u.next=9;return(0,_.editPostApi)(o);case 9:a=u.sent;i=a.data;if((0,g.httpSuccess)(a.status)){setTimeout(function(){(0,y.runInAction)(function(){t.isUploading=false});(0,C.messageSuccess)((0,P.translateI18n)("social.home.post.upload_success"));if(r){r(i.data)}},400)}else{(0,y.runInAction)(function(){t.error=(0,g.messageHttpRequest)();t.isUploading=false})}u.next=17;break;case 14:u.prev=14;u.t0=u["catch"](6);(0,y.runInAction)(function(){t.error=(0,g.messageHttpRequest)(u.t0);t.isUploading=false});case 17:u.prev=17;E.default.done();return u.finish(17);case 20:case"end":return u.stop()}}},e,this,[[6,14,17,20]])}));function t(){return e.apply(this,arguments)}return t}()},{key:"uploadImage",value:function e(t){var r=this;var o=n({},t);this.changeDataImages(o,{isUploading:true});var a=function e(){r.changeDataImages(t,{isUploading:false});var n=t.file?t.file.name:"";(0,C.messageWarning)((0,P.translateI18n)("social.editor.Noti.upload_image_error",{image_name:n}));r.removeImage(t)};var i=function e(t){var a=JSON.parse(t.currentTarget.responseText);r.changeDataImages(o,n({isUploading:false},a.data))};var u=function e(n){var o=Math.round(100*n.loaded/n.total);r.changeDataImages(t,{percentComplete:o})};(0,O.uploadImageApi)(t.file,i,u,a)}},{key:"removeImage",value:function e(t){this.images.splice(this.getIndexImagesByFile(t.file),1)}},{key:"reset",value:function e(){this.percentUpload=0;this.isUploading=false;this.error=null;this.isFocus=false;this.images=[];this.content=""}},{key:"setContent",value:function e(t){this.content=(0,k.convertDataEditor)(t)}},{key:"setLineNumber",value:function e(t){this.lineNumber=t}},{key:"isZoomText",get:function e(){return!(0,k.overMaxString)(this.content)&&!(0,k.overLineNumber)(this.content)}}]);return e}(),s=R(u.prototype,"percentUpload",[y.observable],{enumerable:true,initializer:function e(){return 0}}),l=R(u.prototype,"isUploading",[y.observable],{enumerable:true,initializer:function e(){return false}}),c=R(u.prototype,"error",[y.observable],{enumerable:true,initializer:function e(){return null}}),f=R(u.prototype,"isFocus",[y.observable],{enumerable:true,initializer:function e(){return false}}),p=R(u.prototype,"images",[y.observable],{enumerable:true,initializer:function e(){return[]}}),d=R(u.prototype,"content",[y.observable],{enumerable:true,initializer:function e(){return""}}),v=R(u.prototype,"lineNumber",[y.observable],{enumerable:true,initializer:function e(){return 0}}),R(u.prototype,"addPost",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"addPost"),u.prototype),R(u.prototype,"editPost",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"editPost"),u.prototype),m=R(u.prototype,"setFocusEditor",[y.action],{enumerable:true,initializer:function e(){var t=this;return function(e){t.isFocus=e}}}),R(u.prototype,"uploadImage",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"uploadImage"),u.prototype),h=R(u.prototype,"addImages",[y.action],{enumerable:true,initializer:function e(){var t=this;return function(e){t.images=[].concat(I(t.images),I(e))}}}),b=R(u.prototype,"changeDataImages",[y.action],{enumerable:true,initializer:function e(){var t=this;return function(e,r){var o=t.getIndexImagesByFile(e.file);t.images[o]=n({},t.images[o],r)}}}),R(u.prototype,"removeImage",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"removeImage"),u.prototype),R(u.prototype,"reset",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"reset"),u.prototype),R(u.prototype,"setContent",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"setContent"),u.prototype),R(u.prototype,"setLineNumber",[y.action],Object.getOwnPropertyDescriptor(u.prototype,"setLineNumber"),u.prototype),R(u.prototype,"isZoomText",[y.computed],Object.getOwnPropertyDescriptor(u.prototype,"isZoomText"),u.prototype),u);t.default=N}}]);